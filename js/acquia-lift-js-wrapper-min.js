(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n=[].slice;window.AcquiaLiftJS=function(){function u(n,r,i){var s,o,u,a,f,l,c,h,p;this.owner=n,this.apikey=r,this.opts=i!=null?i:{},this.send=t(this.send,this),this.goal=t(this.goal,this),this.decision=t(this.decision,this),(s=this.opts).server==null&&(s.server="//api.lift.acquia.com"),(o=this.opts).timeout==null&&(o.timeout=5e3),(u=this.opts).cookies==null&&(u.cookies={ttl:2592e3,path:"/"}),(a=this.opts).scodestore==null&&(a.scodestore=CookieLite),(f=this.opts).session==null&&(f.session=typeof (l=this.opts).scodestore=="function"?l.scodestore("mpid"):void 0),(c=this.opts).transport==null&&(c.transport=e),(h=this.opts).batching==null&&(h.batching="off"),((p=this.opts.batching)==="auto"||p==="manual")&&this.batchStart()}var r,i,s,o;return u.prototype.decision=function(e,t,n){var r,i,s,o,u;t==null&&(t={}),n==null&&(n=null),s=[e,"decisions"],r=null;if(t.choices!=null){u=t.choices;for(i in u){o=u[i];if((o!=null?o.join:void 0)==null)continue;s.push(""+i+":"+o.join(",")),r==null&&(r={}),r[i]||(r[i]={code:o[0]})}delete t.choices}return t.fallback!=null&&(r=t.fallback,delete t.fallback),this.send(s,t,null,!0,function(e){var t,i;if(n==null)return;return t=(i=e!=null?e.decisions:void 0)!=null?i:r,n(t,e!=null?e.session:void 0)})},u.prototype.goal=function(e,t,n){var r;return r=[e,"goal"],t.goal!=null&&(r.push(t.goal),delete t.goal),this.send(r,t,null,!0,function(e){var t;if(n==null)return;return t=(e!=null?e.session:void 0)!=null,n(t,e!=null?e.session:void 0)})},u.prototype.send=function(e,t,n,r,u){var a;t.apikey=this.apikey,this.opts.session!=null&&(t.session=this.opts.session),t._t=(new Date).getTime();if(!r||(a=this.opts.batching)!=="auto"&&a!=="manual")return e=""+this.opts.server+"/"+this.owner+"/"+e.join("/")+"?"+i(t),new this.opts.transport(e,n,this.opts.timeout,function(e){return function(t){var n,r,i;try{r=JSON.parse(t),u(r)}catch(s){n=s,u(null)}if((r!=null?r.session:void 0)!=null&&e.opts.cookies!=null)return e.opts.session=r.session,typeof (i=e.opts).scodestore=="function"?i.scodestore("mpid",r.session,e.opts.cookies):void 0}}(this));this.batch.push(s(e,t,u)),this.opts.batching==="auto"&&o(this);return},i=function(e){var t,n,r;n="";for(t in e)r=e[t],n+="&"+t+"="+escape(r);return n},r=function(e,t){var r;return r=null,function(){var i;return i=1<=arguments.length?n.call(arguments,0):[],clearTimeout(r),setTimeout(function(e){return function(){return t.apply(e,i)}}(this),e)}},u.prototype.batchStart=function(){return this.batch=[]},u.prototype.batchSend=function(){var e,t;t=["-","batch"],e=this.batch.concat(),this.batchStart();if(e.length>0)return this.send(t,{},e,!1,function(t){var n,r,i;i=[];for(n in e)i.push(e[n].cb(t!=null?(r=t[n])!=null?r.data:void 0:void 0));return i});return},o=r(20,function(e){return e.batchSend()}),s=function(e,t,n){var r;r={agent:e[0],type:e[1],query:t,cb:n};switch(r.type){case"decisions":e.length>2&&(r.choices=e.slice(2).join("/"));break;case"goal":e.length>2&&(r.goal=e[2])}return r},u}(),e=function(){function t(t,n,r,i){var s;s=e(t,n);if(s==null)return i(null);typeof r=="number"&&(s.timeout=r),s.onload=function(){return i(s.responseText)},s.onerror=s.ontimeout=function(){return i(null)},n!=null?(s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(n))):s.send()}var e;return e=function(e,t){var n,r;return n=t!=null?"POST":"GET",typeof XMLHttpRequest!="undefined"&&XMLHttpRequest!==null&&(r=new XMLHttpRequest),(r!=null?r.withCredentials:void 0)!=null?r.open(n,e,!0):typeof XDomainRequest!="undefined"&&XDomainRequest!==null?(r=new XDomainRequest,r.open(n,e)):r=null,r},t}()}).call(this);
